<!doctype html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      html {
        background: #1a1a2e;
      }
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        padding: 20px;
        margin: 0;
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
        color: white;
        min-height: 100vh;
        opacity: 0;
        animation: fadeIn 0.3s ease-in forwards;
        animation-delay: 0.1s;
      }
      @keyframes fadeIn {
        to {
          opacity: 1;
        }
      }
      .header {
        text-align: center;
        margin-bottom: 30px;
      }
      .logo {
        font-size: 3em;
        margin-bottom: 10px;
      }
      h1 {
        margin: 0;
        font-size: 2.5em;
        background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }
      .subtitle {
        font-size: 1.2em;
        opacity: 0.8;
        margin: 10px 0 0 0;
      }
      .launcher-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-top: 30px;
      }
      .game-card {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        padding: 25px;
        border-radius: 15px;
        text-align: center;
        transition: all 0.3s ease;
        cursor: pointer;
      }
      .game-card:hover {
        transform: translateY(-5px);
        background: rgba(255, 255, 255, 0.15);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      }
      .game-icon {
        font-size: 4em;
        margin-bottom: 15px;
        display: block;
      }
      .game-title {
        font-size: 1.5em;
        font-weight: bold;
        margin-bottom: 10px;
      }
      .game-description {
        opacity: 0.8;
        margin-bottom: 20px;
        line-height: 1.4;
      }
      .launch-btn {
        background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
        color: white;
        border: none;
        padding: 12px 30px;
        border-radius: 25px;
        font-size: 1em;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        width: 100%;
      }
      .launch-btn:hover {
        transform: scale(1.05);
        box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
      }
      .launch-btn:active {
        transform: scale(0.98);
      }
      .launch-btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
      }
      .status {
        text-align: center;
        margin-top: 20px;
        padding: 15px;
        background: rgba(0, 0, 0, 0.3);
        border-radius: 10px;
        font-family: 'Courier New', monospace;
      }
      .quick-actions {
        display: flex;
        gap: 10px;
        justify-content: center;
        margin-top: 30px;
        flex-wrap: wrap;
      }
      .quick-btn {
        background: rgba(255, 255, 255, 0.1);
        color: white;
        border: 1px solid rgba(255, 255, 255, 0.3);
        padding: 8px 16px;
        border-radius: 20px;
        font-size: 0.9em;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      .quick-btn:hover {
        background: rgba(255, 255, 255, 0.2);
      }
      .settings-card {
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        padding: 20px;
        border-radius: 10px;
        margin-top: 20px;
      }
      .input-group {
        margin-bottom: 15px;
      }
      .input-group label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
        opacity: 0.9;
      }
      .input-group input {
        width: 100%;
        padding: 8px 12px;
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 5px;
        background: rgba(0, 0, 0, 0.3);
        color: white;
        font-size: 0.9em;
      }
      .input-group input::placeholder {
        color: rgba(255, 255, 255, 0.5);
      }
    </style>
  </head>
  <body>
    <div class="header">
      <div class="logo">üéÆ</div>
      <h1>RetroArch Launcher</h1>
      <p class="subtitle">Launch RetroArch games directly from your WebView</p>
    </div>

    <div class="launcher-grid">
      <div class="game-card" onclick="launchRetroArch('gba', 'mgba')">
        <div class="game-icon">üè∞</div>
        <div class="game-title">Game Boy Advance</div>
        <div class="game-description">Launch GBA games with mGBA core</div>
        <button class="launch-btn">Launch GBA Game</button>
      </div>

      <div class="game-card" onclick="launchRetroArch('snes', 'snes9x')">
        <div class="game-icon">üéØ</div>
        <div class="game-title">Super Nintendo</div>
        <div class="game-description">Play SNES games with Snes9x core</div>
        <button class="launch-btn">Launch SNES Game</button>
      </div>

      <div class="game-card" onclick="launchRetroArch('genesis', 'genesis_plus_gx')">
        <div class="game-icon">üíé</div>
        <div class="game-title">Sega Genesis</div>
        <div class="game-description">Genesis/Mega Drive with Genesis Plus GX</div>
        <button class="launch-btn">Launch Genesis Game</button>
      </div>

      <div class="game-card" onclick="launchRetroArch('nes', 'nestopia')">
        <div class="game-icon">üî•</div>
        <div class="game-title">Nintendo NES</div>
        <div class="game-description">Classic NES games with Nestopia core</div>
        <button class="launch-btn">Launch NES Game</button>
      </div>

      <div class="game-card" onclick="launchRetroArch('psx', 'pcsx_rearmed')">
        <div class="game-icon">üíø</div>
        <div class="game-title">PlayStation 1</div>
        <div class="game-description">PSX games with PCSX ReARMed core</div>
        <button class="launch-btn">Launch PSX Game</button>
      </div>

      <div class="game-card" onclick="openRetroArchMain()">
        <div class="game-icon">‚öôÔ∏è</div>
        <div class="game-title">RetroArch Main</div>
        <div class="game-description">Open RetroArch main interface</div>
        <button class="launch-btn">Open RetroArch</button>
      </div>

      <div class="game-card" onclick="writeFile()">
        <div class="game-icon">üìù</div>
        <div class="game-title">Write File</div>
        <div class="game-description">Write a text file to document directory</div>
        <button class="launch-btn">Write File</button>
      </div>

      <div class="game-card" onclick="readFile()">
        <div class="game-icon">üìñ</div>
        <div class="game-title">Read File</div>
        <div class="game-description">Read the text file from document directory</div>
        <button class="launch-btn">Read File</button>
      </div>
    </div>

    <div class="settings-card">
      <h3>ROM Settings</h3>
      <div class="input-group">
        <label for="romPath">ROM Path:</label>
        <input type="text" id="romPath" placeholder="/storage/emulated/0/Download/game.zip" 
               value="/storage/emulated/0/Download/minish.zip">
      </div>
      <div class="input-group">
        <label for="configPath">Config Path:</label>
        <input type="text" id="configPath" placeholder="/storage/emulated/0/Android/data/com.retroarch.aarch64/files/retroarch.cfg" 
               value="/storage/emulated/0/Android/data/com.retroarch.aarch64/files/retroarch.cfg">
      </div>
    </div>

    <div class="quick-actions">
      <button class="quick-btn" onclick="sendMessage('Open RetroArch Settings')">‚öôÔ∏è Settings</button>
      <button class="quick-btn" onclick="sendMessage('Scan ROMs')">üìÅ Scan ROMs</button>
      <button class="quick-btn" onclick="sendMessage('Show Saves')">üíæ Save States</button>
      <button class="quick-btn" onclick="sendMessage('Controls')">üéÆ Controls</button>
      <button class="quick-btn" onclick="sendMessage('About')">‚ÑπÔ∏è About</button>
    </div>

    <div class="status" id="status">
      Ready to launch RetroArch games...
    </div>

    <script>
      function updateStatus(message) {
        document.getElementById('status').textContent = message;
      }

      function launchRetroArch(console, core) {
        const romPath = document.getElementById('romPath').value;
        const configPath = document.getElementById('configPath').value;

        updateStatus(`Launching ${console.toUpperCase()} game with ${core} core...`);

        const launchConfig = {
          type: 'LAUNCH_RETROARCH',
          console: console,
          core: core,
          romPath: romPath,
          configPath: configPath,
          timestamp: new Date().toISOString()
        };

        if (window.ReactNativeWebView) {
          window.ReactNativeWebView.postMessage(JSON.stringify(launchConfig));
        } else {
          updateStatus('Error: ReactNativeWebView not available');
        }
      }

      function openRetroArchMain() {
        updateStatus('Opening RetroArch main interface...');

        const message = {
          type: 'OPEN_RETROARCH_MAIN',
          timestamp: new Date().toISOString()
        };

        if (window.ReactNativeWebView) {
          window.ReactNativeWebView.postMessage(JSON.stringify(message));
        } else {
          updateStatus('Error: ReactNativeWebView not available');
        }
      }

      function writeFile() {
        const content = `Hello from WebView! Current time: ${new Date().toISOString()}`;
        updateStatus('Requesting file write...');

        const message = {
          type: 'WRITE_FILE',
          content: content,
          timestamp: new Date().toISOString()
        };

        if (window.ReactNativeWebView) {
          window.ReactNativeWebView.postMessage(JSON.stringify(message));
        } else {
          updateStatus('Error: ReactNativeWebView not available');
        }
      }

      function readFile() {
        updateStatus('Requesting file read...');

        const message = {
          type: 'READ_FILE',
          timestamp: new Date().toISOString()
        };

        if (window.ReactNativeWebView) {
          window.ReactNativeWebView.postMessage(JSON.stringify(message));
        } else {
          updateStatus('Error: ReactNativeWebView not available');
        }
      }

      function sendMessage(action) {
        updateStatus(`Action: ${action}`);

        const message = {
          type: 'RETROARCH_ACTION',
          action: action,
          timestamp: new Date().toISOString()
        };

        if (window.ReactNativeWebView) {
          window.ReactNativeWebView.postMessage(JSON.stringify(message));
        } else {
          updateStatus('Error: ReactNativeWebView not available');
        }
      }

      // Listen for messages from React Native
      function handleMessage(event) {
        try {
          let data;
          if (typeof event.data === 'string') {
            try {
              data = JSON.parse(event.data);
            } catch {
              data = { text: event.data, type: 'SIMPLE_MESSAGE' };
            }
          } else {
            data = event.data;
          }

          if (data.type === 'LAUNCH_STATUS') {
            updateStatus(data.message);
          } else if (data.type === 'ERROR') {
            updateStatus(`Error: ${data.message}`);
          } else if (data.type === 'FILE_WRITE_SUCCESS') {
            updateStatus(`‚úÖ ${data.message}`);
          } else if (data.type === 'FILE_READ_SUCCESS') {
            updateStatus(`üìñ File content: ${data.message}`);
          } else if (data.type === 'FILE_READ_ERROR') {
            updateStatus(`‚ùå ${data.message}`);
          } else {
            updateStatus(`Received: ${data.text || event.data}`);
          }
        } catch (error) {
          console.error('Error processing message:', error);
        }
      }

      // Set up message listeners
      document.addEventListener('message', handleMessage);
      window.addEventListener('message', handleMessage);

      // Initialize
      updateStatus('RetroArch Launcher ready! Configure your ROM path and select a game to launch.');
    </script>
  </body>
</html>